## Senior Research Project: Anomaly Detection on Computer Networks using Machine Learning
### Advisor: Dr. Michael Wollowski
### In Collaboration with MIT Lincoln Laboratory
*Ongoing; Started August 2021*

### Motivation for Research
Given the computational power available to modern hackers, the scale of the cyber attacks that could be performed today are much larger than what is possible to track manually in real time. To speed up network security analysis, cyber security teams can utilize tools based on machine learning algorithms for dynamic network analysis. 
After research over existing work in the area, my team and I developed an understanding of ways to work with data, as well as the types of data to investigate to assist in the creation of such a tool. Our intended approach for initial data exploration and analysis uses random forests, convolutional neural networks, and feed-forward neural networks. We focus on exploring network packet data to discern between malicious (DDoS) and benign network activity. So far, we have used pre-developed algorithms from python libraries Tensorflow and Scikit-Learn as foundations for our research.

### Data
Many open-source datasets are available, using both real and simulated network data, for identifying malicious network traffic. One of the datasets we used is a dataset with network traffic metadata, with each packet labeled as either part of benign traffic or DDoS (Distributed Denial of Service) traffic [https://www.kaggle.com/devendra416/ddos-datasets]. This dataset contains information about network traffic during simulated DDoS attacks, produced by multiple researchers from the years 2016-2018. The dataset consists of 12,794,627 records, each representing a single flow (forward or reverse), has 84 total features, and has a balanced distribution of DDoS and benign records. 
We chose to work with this dataset because it is specifically focuses on DDoS attacks, making a good starting point for training models to predict one type of attack. Some of the most significant features include the timestamp, source and destination IPs, source port, and total forwarded packets. The dataset draws from 3 other simulated DDoS datasets, produced from 2016-2018. [https://www.ijcseonline.org/pdf_paper_view.php?paper_id=4011&28-IJCSE-06600.pdf ]. The dataset is large enough (6.97 GB, with 84 features and no missing entries) to be used for training data-hungry models such as deep learning networks and random forests.

### My Contributions
I began by processing the DDoS dataset. First, I identified all non-numerical variables, which in this case were the flow ID, source IP, destination IP, and timestamp. The flow ID was just a combination of the other 3 non-numeric features, so I chose to remove that feature. I then converted the timestamp to a float, and encoded the source and destination IPs as integers, so that they could be fed directly into a model as numerical features. I chose to anonymize the IPs because we would like to predict based on general patterns in network traffic data, not for a specific IP or machine. I chose to keep the timestamp and IP information, even though all the data was simulated, because having multiple packets sent to a single IP in a short time frame could be one of the main indicators of a DDoS attack. Our team wants to build a model that can identify true indicators of DDoS attacks in practice, rather than mistakenly identifying the algorithms used to generate the data instead of learning to predict actual attacks. 

### Findings
The first model we are training with this dataset is the random forest classifier. With the random forest classifier some features caused errors when used to train the classifier. These features contained data that did not get processed well by SkLearn’s random forest classifier. In particular protocol, flow rates, forward rate averages, and backwards rate averages. From testing these features do not have NaN or infinite values, but they cause ValueErrors so they do not work with the classifier.
Our team is also currently in the process of testing other methods for predicting whether network traffic is malicious (DDoS) or benign using deep learning. We are also exploring ways that the data can be restructured for easier analysis using deep learning techniques. 

## Publication, Presentations & Awards
I intend to publish a paper on this work upon the conclusion of the project in May 2022. This project has been presented in a Research Laboratory group at Rose-Hulman and will be presented at multiple student work showcases, and potentially at a conference, later in the 2021-22 academic year.

### Related Work
Ahmada and Alsmadi researched machine learning applications in security in their paper “Machine Learning Approaches to IoT Security: A systematic literature review” [https://www.sciencedirect.com/science/article/pii/S2542660521000093?via%3Dihub]. This paper is based on the IoT dataset [https://www.stratosphereips.org/datasets-iot23] and gives an overview of some of the major security risks facing IoT devices today and discusses various methods for helping to make these devices more secure. Specifically, the limited computing power and resources of IoT devices makes it difficult to implement specific tools used on other devices for security, so the main approaches are to use signature-based (misuse/knowledge) and anomaly-based (behavior) approaches for detecting malicious behavior. The anomaly based (behavior) approaches described here are used as a reference for helping us build our own anomaly detection algorithms. The paper also describes at a high level some relevant attacks, such as Slowloris, packet flooding, and amplification (among many others). 
Stoian discussed anomaly detection in network traffic in his student thesis “Machine Learning for Anomaly Detection in IoT networks” [http://essay.utwente.nl/81979/1/Stoian_BA_EEMCS.pdf]. His paper gives an overview of several machine learning techniques and then applies them to the IoT-23 dataset. The set of algorithms applied is: Random Forest, Naive Bayes, Multi Layer Perceptron, Artificial Neural Network, Support Vector Machine, and AdaBoost. This paper also covers ways to evaluate the effectiveness and accuracy of the algorithms. Overall this paper found that Random Forest was the most accurate predictor.
Alin, Chemchem, Nolot, and Flauzac used a hierarchical approach to classify types of cyberattacks in their paper “Towards a Hierarchical Deep Learning Approach for Intrusion Detection” [https://www.researchgate.net/publication/340787961_Towards_a_Hierarchical_Deep_Learning_Approach_for_Intrusion_Detection]. The basic idea is that traffic flow is first categorized into an attack or normal traffic by one model, after which another model would then be able to classify it into a specific attack type (if it was identified as an attack). The authors also applied various types of models and recorded performance of each. Hierarchical classification methods for cyberattacks will be further investigated as a part of our work. 

### Tools and Methods Used
Python – All code for this project was written in Python, using libraries such as TensorFlow and Scikit-Learn. <br>
Jupyter Notebooks – All code for this project so far was written using Jupyter Notebooks. There may be an opportunity to build a tool once a proof of concept is demonstrated to have high effectiveness in predicting cyberattacks. <br>
